<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- æ¯æ—¥è¯æ±‡æ›´æ–° 2026-02-24 08:04:10 -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é›…æ€æ¯æ—¥10è¯ - Azure TTSä¸“ä¸šå‘éŸ³</title>
  <style>
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;background:#0f172a;color:#e2e8f0}
    .wrap{max-width:960px;margin:0 auto;padding:20px}
    h1{font-size:32px;margin:20px 0 10px;text-align:center}
    .sub{text-align:center;color:#94a3b8;margin-bottom:30px}
    .tts-badge{background:#10b981;color:#fff;padding:4px 12px;border-radius:12px;font-size:14px;margin-left:8px}
    .card{background:#1e293b;border-radius:12px;padding:24px;margin-bottom:20px;box-shadow:0 4px 6px rgba(0,0,0,0.2)}
    .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .word{font-size:28px;font-weight:bold;color:#60a5fa}
    .phonetic{color:#94a3b8;font-size:16px;margin-left:12px}
    .level{background:#8b5cf6;color:#fff;padding:4px 8px;border-radius:6px;font-size:12px}
    .meaning{font-size:18px;margin:12px 0;color:#fbbf24}
    .definition{color:#94a3b8;margin:8px 0;line-height:1.6}
    .example{background:#334155;padding:12px;border-radius:8px;margin:12px 0;border-left:3px solid #10b981}
    .example-text{margin-bottom:6px}
    .example-trans{color:#94a3b8;font-size:14px}
    .btn-group{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#3b82f6;color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:14px;transition:all 0.2s}
    button:hover{background:#2563eb;transform:translateY(-1px)}
    button:active{transform:translateY(0)}
    .btn-success{background:#10b981}
    .btn-success:hover{background:#059669}
    .btn-danger{background:#ef4444}
    .btn-danger:hover{background:#dc2626}
    .muted{color:#64748b;font-size:14px}
    .history-section{margin-top:40px}
    .history-item{background:#1e293b;border-radius:12px;padding:16px;margin-bottom:12px}
    .history-header{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:8px;border-radius:8px;transition:background 0.2s}
    .history-header:hover{background:#334155}
    .history-date{font-size:18px;font-weight:bold;color:#60a5fa}
    .history-badge{background:#334155;color:#94a3b8;padding:4px 12px;border-radius:6px;font-size:14px}
    .history-words{margin-top:16px;display:none}
    .history-words.active{display:block}
    .history-word-item{background:#334155;padding:12px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center}
    .history-word-main{flex:1}
    .history-word-text{font-size:16px;color:#e2e8f0}
    .history-word-phonetic{color:#94a3b8;font-size:14px;margin-left:8px}
    .history-word-meaning{color:#fbbf24;font-size:14px;margin-top:4px}
    .stats{background:#1e293b;border-radius:12px;padding:20px;margin-top:20px;text-align:center}
    .stats-number{font-size:36px;font-weight:bold;color:#10b981}
    .stats-label{color:#94a3b8;margin-top:8px}
    #loading{display:none;color:#10b981;font-size:14px;margin-left:8px}
    .progress-bar{background:#334155;height:8px;border-radius:4px;margin:20px 0;overflow:hidden}
    .progress-fill{background:linear-gradient(90deg,#10b981,#60a5fa);height:100%;transition:width 0.3s}
  </style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ¯ é›…æ€æ¯æ—¥10è¯ <span class="tts-badge">Azure TTS</span></h1>
  <div class="sub">ğŸ¤– å¾®è½¯Azureç¥ç»ç½‘ç»œTTS â€¢ ğŸ“ é›…æ€æ ¸å¿ƒè¯æ±‡ â€¢ ğŸ“š æ¯æ—¥ç²¾è¿›</div>
  
  <div class="btn-group" style="justify-content:center">
    <button class="btn-success" onclick="playAllWords()">ğŸ”Š æ’­æ”¾ä»Šæ—¥10è¯</button>
    <button onclick="playAllExamples()">ğŸ§ æ’­æ”¾ä»Šæ—¥ä¾‹å¥</button>
    <button class="btn-danger" onclick="stopAllAudio()">â¹ åœæ­¢</button>
    <button onclick="refreshToday(true)">ğŸ”„ é‡æ–°æŠ½å–</button>
    <span id="loading">â³ åŠ è½½ä¸­...</span>
  </div>

  <div style="margin:20px 0">
    <div id="today-date" style="text-align:center;color:#94a3b8;font-size:16px">ä»Šæ—¥æ—¥æœŸï¼š2026-02-24ï¼ˆ10ä¸ªï¼‰â€¢ ğŸ¤– å¾®è½¯Azureç¥ç»ç½‘ç»œTTS â€¢ æ›´æ–°æ—¶é—´: 08:04:10</div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress" style="width:0%"></div>
    </div>
  </div>

  <div id="today"></div>

  <div class="history-section">
    <h2>ğŸ“š å­¦ä¹ å†å²</h2>
    <div class="muted">ç‚¹å‡»æ—¥æœŸæŸ¥çœ‹è¯¦ç»†å•è¯åˆ—è¡¨</div>
    <div id="history"></div>
    <div class="stats">
      <div class="stats-number" id="total-words">0</div>
      <div class="stats-label">ç´¯è®¡å­¦ä¹ å•è¯æ•°</div>
    </div>
  </div>
</div>

<script>
// ==================== é…ç½® ====================
const DEFAULT_TTS_PROXY_URL = 'https://web-x0ya.onrender.com/tts';
const TODAY_VOICE = 'en-US-JennyNeural';
const EXAMPLE_VOICE = 'en-US-JennyNeural';

function getTtsProxyUrl() {
  const q = new URLSearchParams(window.location.search).get('tts');
  if (q) {
    localStorage.setItem('ttsProxyUrl', q);
    return q;
  }
  const saved = localStorage.getItem('ttsProxyUrl');
  return saved || DEFAULT_TTS_PROXY_URL;
}

const TTS_PROXY_URL = getTtsProxyUrl();

// ==================== é›…æ€è¯æ±‡åº“ ====================
const IELTS_VOCAB = [
  {word:"abandon",phonetic:"/É™ËˆbÃ¦ndÉ™n/",chinese:"æ”¾å¼ƒ",englishDef:"To give up completely",example:"Don't abandon hope in difficult times.",exampleTrans:"ä¸è¦åœ¨å›°éš¾æ—¶æœŸæ”¾å¼ƒå¸Œæœ›ã€‚",level:"6.5+"},
  {word:"accomplish",phonetic:"/É™ËˆkÊŒmplÉªÊƒ/",chinese:"å®Œæˆ",englishDef:"To succeed in doing something",example:"She accomplished her goal of graduating with honors.",exampleTrans:"å¥¹å®Œæˆäº†ä»¥ä¼˜å¼‚æˆç»©æ¯•ä¸šçš„ç›®æ ‡ã€‚",level:"6.0+"},
  {word:"acknowledge",phonetic:"/É™kËˆnÉ’lÉªdÊ’/",chinese:"æ‰¿è®¤",englishDef:"To accept or admit the existence of something",example:"He acknowledged his mistake and apologized.",exampleTrans:"ä»–æ‰¿è®¤äº†è‡ªå·±çš„é”™è¯¯å¹¶é“æ­‰ã€‚",level:"6.5+"},
  {word:"adequate",phonetic:"/ËˆÃ¦dÉªkwÉ™t/",chinese:"è¶³å¤Ÿçš„",englishDef:"Enough or satisfactory for a particular purpose",example:"The salary is adequate for living expenses.",exampleTrans:"è¿™ä»½å·¥èµ„è¶³å¤Ÿæ”¯ä»˜ç”Ÿæ´»è´¹ç”¨ã€‚",level:"6.0+"},
  {word:"advocate",phonetic:"/ËˆÃ¦dvÉ™keÉªt/",chinese:"æå€¡",englishDef:"To publicly support or recommend",example:"Many scientists advocate for renewable energy.",exampleTrans:"è®¸å¤šç§‘å­¦å®¶æå€¡ä½¿ç”¨å¯å†ç”Ÿèƒ½æºã€‚",level:"7.0+"},
  {word:"ambiguous",phonetic:"/Ã¦mËˆbÉªÉ¡juÉ™s/",chinese:"æ¨¡ç³Šçš„",englishDef:"Having more than one possible meaning",example:"His answer was ambiguous and confusing.",exampleTrans:"ä»–çš„å›ç­”æ¨¡æ£±ä¸¤å¯ï¼Œä»¤äººå›°æƒ‘ã€‚",level:"7.0+"},
  {word:"anticipate",phonetic:"/Ã¦nËˆtÉªsÉªpeÉªt/",chinese:"é¢„æœŸ",englishDef:"To expect or predict something",example:"We anticipate a rise in sales next quarter.",exampleTrans:"æˆ‘ä»¬é¢„æœŸä¸‹ä¸ªå­£åº¦é”€å”®é¢ä¼šä¸Šå‡ã€‚",level:"6.5+"},
  {word:"arbitrary",phonetic:"/ËˆÉ‘ËbÉªtrÉ™ri/",chinese:"ä»»æ„çš„",englishDef:"Based on random choice rather than reason",example:"The decision seemed arbitrary and unfair.",exampleTrans:"è¿™ä¸ªå†³å®šä¼¼ä¹å¾ˆæ­¦æ–­ä¸”ä¸å…¬å¹³ã€‚",level:"7.5+"},
  {word:"assess",phonetic:"/É™Ëˆses/",chinese:"è¯„ä¼°",englishDef:"To evaluate or estimate the nature, value or quality of something",example:"Teachers assess students' progress regularly.",exampleTrans:"è€å¸ˆå®šæœŸè¯„ä¼°å­¦ç”Ÿçš„è¿›æ­¥ã€‚",level:"6.0+"},
  {word:"assure",phonetic:"/É™ËˆÊƒÊŠÉ™(r)/",chinese:"ä¿è¯",englishDef:"To tell someone confidently that something is true",example:"I can assure you that the information is accurate.",exampleTrans:"æˆ‘å¯ä»¥å‘ä½ ä¿è¯è¿™ä¸ªä¿¡æ¯æ˜¯å‡†ç¡®çš„ã€‚",level:"6.0+"},
  {word:"beneficial",phonetic:"/ËŒbenÉªËˆfÉªÊƒl/",chinese:"æœ‰ç›Šçš„",englishDef:"Favorable or advantageous",example:"Exercise is beneficial for your health.",exampleTrans:"è¿åŠ¨å¯¹ä½ çš„å¥åº·æœ‰ç›Šã€‚",level:"6.0+"},
  {word:"capacity",phonetic:"/kÉ™ËˆpÃ¦sÉ™ti/",chinese:"èƒ½åŠ›",englishDef:"The maximum amount that something can contain or produce",example:"The stadium has a capacity of 50,000 people.",exampleTrans:"è¿™ä¸ªä½“è‚²åœºå¯ä»¥å®¹çº³5ä¸‡äººã€‚",level:"6.0+"},
  {word:"coherent",phonetic:"/kÉ™ÊŠËˆhÉªÉ™rÉ™nt/",chinese:"è¿è´¯çš„",englishDef:"Logical and well-organized",example:"She presented a coherent argument.",exampleTrans:"å¥¹æå‡ºäº†ä¸€ä¸ªè¿è´¯çš„è®ºè¯ã€‚",level:"7.0+"},
  {word:"compelling",phonetic:"/kÉ™mËˆpelÉªÅ‹/",chinese:"ä»¤äººä¿¡æœçš„",englishDef:"Evoking interest or attention",example:"The evidence was compelling enough to convince the jury.",exampleTrans:"è¯æ®è¶³å¤Ÿä»¤äººä¿¡æœï¼Œè¯´æœäº†é™ªå®¡å›¢ã€‚",level:"6.5+"},
  {word:"comprehensive",phonetic:"/ËŒkÉ’mprÉªËˆhensÉªv/",chinese:"å…¨é¢çš„",englishDef:"Including all or nearly all elements",example:"The report provides a comprehensive analysis.",exampleTrans:"è¿™ä»½æŠ¥å‘Šæä¾›äº†å…¨é¢çš„åˆ†æã€‚",level:"6.5+"},
  {word:"contradict",phonetic:"/ËŒkÉ’ntrÉ™ËˆdÉªkt/",chinese:"çŸ›ç›¾",englishDef:"To say the opposite of what someone else has said",example:"Her actions contradict her words.",exampleTrans:"å¥¹çš„è¡Œä¸ºä¸å¥¹çš„è¯ç›¸çŸ›ç›¾ã€‚",level:"6.5+"},
  {word:"crucial",phonetic:"/ËˆkruËÊƒl/",chinese:"å…³é”®çš„",englishDef:"Extremely important",example:"Teamwork is crucial for success.",exampleTrans:"å›¢é˜Ÿåˆä½œå¯¹æˆåŠŸè‡³å…³é‡è¦ã€‚",level:"6.0+"},
  {word:"demonstrate",phonetic:"/ËˆdemÉ™nstreÉªt/",chinese:"è¯æ˜",englishDef:"To show clearly and deliberately",example:"The experiment demonstrates the theory.",exampleTrans:"è¿™ä¸ªå®éªŒè¯æ˜äº†è¿™ä¸ªç†è®ºã€‚",level:"6.0+"},
  {word:"derive",phonetic:"/dÉªËˆraÉªv/",chinese:"è·å¾—",englishDef:"To obtain something from a source",example:"Many English words derive from Latin.",exampleTrans:"è®¸å¤šè‹±è¯­å•è¯æºè‡ªæ‹‰ä¸è¯­ã€‚",level:"6.5+"},
  {word:"diminish",phonetic:"/dÉªËˆmÉªnÉªÊƒ/",chinese:"å‡å°‘",englishDef:"To make or become less",example:"The importance of this issue should not be diminished.",exampleTrans:"è¿™ä¸ªé—®é¢˜çš„é‡è¦æ€§ä¸åº”è¢«å‰Šå¼±ã€‚",level:"6.5+"},
  {word:"distinct",phonetic:"/dÉªËˆstÉªÅ‹kt/",chinese:"æ˜æ˜¾çš„",englishDef:"Recognizably different",example:"There are two distinct groups in the population.",exampleTrans:"äººç¾¤ä¸­æœ‰ä¸¤ä¸ªæ˜æ˜¾ä¸åŒçš„ç¾¤ä½“ã€‚",level:"6.0+"},
  {word:"diverse",phonetic:"/daÉªËˆvÉœËs/",chinese:"å¤šæ ·çš„",englishDef:"Showing a great deal of variety",example:"The city has a diverse population.",exampleTrans:"è¿™ä¸ªåŸå¸‚æœ‰å¤šå…ƒåŒ–çš„äººå£ã€‚",level:"6.0+"},
  {word:"elaborate",phonetic:"/ÉªËˆlÃ¦bÉ™rÉ™t/",chinese:"è¯¦å°½çš„",englishDef:"Involving many carefully arranged parts",example:"She made elaborate plans for the wedding.",exampleTrans:"å¥¹ä¸ºå©šç¤¼åˆ¶å®šäº†è¯¦å°½çš„è®¡åˆ’ã€‚",level:"7.0+"},
  {word:"eliminate",phonetic:"/ÉªËˆlÉªmÉªneÉªt/",chinese:"æ¶ˆé™¤",englishDef:"To completely remove or get rid of",example:"We need to eliminate errors in the system.",exampleTrans:"æˆ‘ä»¬éœ€è¦æ¶ˆé™¤ç³»ç»Ÿä¸­çš„é”™è¯¯ã€‚",level:"6.0+"},
  {word:"emerge",phonetic:"/ÉªËˆmÉœËdÊ’/",chinese:"å‡ºç°",englishDef:"To become known or apparent",example:"New evidence has emerged in the case.",exampleTrans:"æ¡ˆä»¶ä¸­å‡ºç°äº†æ–°è¯æ®ã€‚",level:"6.0+"},
  {word:"emphasize",phonetic:"/ËˆemfÉ™saÉªz/",chinese:"å¼ºè°ƒ",englishDef:"To give special importance to something",example:"The teacher emphasized the importance of practice.",exampleTrans:"è€å¸ˆå¼ºè°ƒäº†ç»ƒä¹ çš„é‡è¦æ€§ã€‚",level:"6.0+"},
  {word:"enhance",phonetic:"/ÉªnËˆhÉ‘Ëns/",chinese:"æé«˜",englishDef:"To improve the quality or value of something",example:"Technology can enhance learning experiences.",exampleTrans:"æŠ€æœ¯å¯ä»¥æå‡å­¦ä¹ ä½“éªŒã€‚",level:"6.5+"},
  {word:"establish",phonetic:"/ÉªËˆstÃ¦blÉªÊƒ/",chinese:"å»ºç«‹",englishDef:"To set up on a firm or permanent basis",example:"The company was established in 1990.",exampleTrans:"è¯¥å…¬å¸æˆç«‹äº1990å¹´ã€‚",level:"6.0+"},
  {word:"evident",phonetic:"/ËˆevÉªdÉ™nt/",chinese:"æ˜æ˜¾çš„",englishDef:"Clearly seen or understood",example:"It was evident that she was tired.",exampleTrans:"å¾ˆæ˜æ˜¾å¥¹ç´¯äº†ã€‚",level:"6.0+"},
  {word:"exceed",phonetic:"/ÉªkËˆsiËd/",chinese:"è¶…è¿‡",englishDef:"To be greater than a number or amount",example:"Sales exceeded expectations this year.",exampleTrans:"ä»Šå¹´çš„é”€å”®é¢è¶…å‡ºäº†é¢„æœŸã€‚",level:"6.0+"},
  {word:"facilitate",phonetic:"/fÉ™ËˆsÉªlÉªteÉªt/",chinese:"ä¿ƒè¿›",englishDef:"To make an action or process easier",example:"Technology facilitates communication.",exampleTrans:"æŠ€æœ¯ä¿ƒè¿›äº†æ²Ÿé€šã€‚",level:"7.0+"},
  {word:"feasible",phonetic:"/ËˆfiËzÉ™bl/",chinese:"å¯è¡Œçš„",englishDef:"Possible and practical to do easily",example:"The plan seems feasible within our budget.",exampleTrans:"è¿™ä¸ªè®¡åˆ’åœ¨æˆ‘ä»¬çš„é¢„ç®—å†…ä¼¼ä¹æ˜¯å¯è¡Œçš„ã€‚",level:"7.0+"},
  {word:"fluctuate",phonetic:"/ËˆflÊŒktÊƒueÉªt/",chinese:"æ³¢åŠ¨",englishDef:"To rise and fall irregularly",example:"Prices fluctuate according to demand.",exampleTrans:"ä»·æ ¼æ ¹æ®éœ€æ±‚æ³¢åŠ¨ã€‚",level:"7.0+"},
  {word:"fundamental",phonetic:"/ËŒfÊŒndÉ™Ëˆmentl/",chinese:"åŸºæœ¬çš„",englishDef:"Forming a necessary base or core",example:"Reading is a fundamental skill.",exampleTrans:"é˜…è¯»æ˜¯ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ã€‚",level:"6.5+"},
  {word:"generate",phonetic:"/ËˆdÊ’enÉ™reÉªt/",chinese:"äº§ç”Ÿ",englishDef:"To cause something to exist",example:"The program generates reports automatically.",exampleTrans:"è¯¥ç¨‹åºè‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šã€‚",level:"6.0+"},
  {word:"implement",phonetic:"/ËˆÉªmplÉªment/",chinese:"å®æ–½",englishDef:"To put a plan or system into operation",example:"The government will implement new policies.",exampleTrans:"æ”¿åºœå°†å®æ–½æ–°æ”¿ç­–ã€‚",level:"6.5+"},
  {word:"inherent",phonetic:"/ÉªnËˆhÉªÉ™rÉ™nt/",chinese:"å›ºæœ‰çš„",englishDef:"Existing as a natural part of something",example:"Risk is inherent in any business.",exampleTrans:"é£é™©æ˜¯ä»»ä½•ä¸šåŠ¡å›ºæœ‰çš„ã€‚",level:"7.5+"},
  {word:"initiate",phonetic:"/ÉªËˆnÉªÊƒieÉªt/",chinese:"å‘èµ·",englishDef:"To cause a process to begin",example:"Who initiated this project?",exampleTrans:"è°å‘èµ·äº†è¿™ä¸ªé¡¹ç›®ï¼Ÿ",level:"6.5+"},
  {word:"integrate",phonetic:"/ËˆÉªntÉªÉ¡reÉªt/",chinese:"æ•´åˆ",englishDef:"To combine parts into a whole",example:"We need to integrate new technology into our workflow.",exampleTrans:"æˆ‘ä»¬éœ€è¦å°†æ–°æŠ€æœ¯æ•´åˆåˆ°æˆ‘ä»¬çš„å·¥ä½œæµç¨‹ä¸­ã€‚",level:"6.5+"},
  {word:"interpret",phonetic:"/ÉªnËˆtÉœËprÉªt/",chinese:"è§£é‡Š",englishDef:"To explain the meaning of something",example:"How do you interpret these results?",exampleTrans:"ä½ å¦‚ä½•è§£é‡Šè¿™äº›ç»“æœï¼Ÿ",level:"6.5+"},
  {word:"legitimate",phonetic:"/lÉªËˆdÊ’ÉªtÉªmÉ™t/",chinese:"åˆæ³•çš„",englishDef:"Conforming to the law or rules",example:"She has a legitimate claim to the property.",exampleTrans:"å¥¹å¯¹è¿™å¤„æˆ¿äº§æœ‰åˆæ³•è¦æ±‚æƒã€‚",level:"7.0+"},
  {word:"maintain",phonetic:"/meÉªnËˆteÉªn/",chinese:"ç»´æŒ",englishDef:"To keep in an existing state",example:"It's important to maintain a healthy diet.",exampleTrans:"ä¿æŒå¥åº·çš„é¥®é£Ÿå¾ˆé‡è¦ã€‚",level:"6.0+"},
  {word:"manifest",phonetic:"/ËˆmÃ¦nÉªfest/",chinese:"è¡¨æ˜",englishDef:"To show or demonstrate clearly",example:"Her kindness manifested in many ways.",exampleTrans:"å¥¹çš„å–„è‰¯ä»¥å¤šç§æ–¹å¼è¡¨ç°å‡ºæ¥ã€‚",level:"7.5+"},
  {word:"mutual",phonetic:"/ËˆmjuËtÊƒuÉ™l/",chinese:"ç›¸äº’çš„",englishDef:"Felt or done by each toward the other",example:"They have mutual respect for each other.",exampleTrans:"ä»–ä»¬å½¼æ­¤å°Šé‡ã€‚",level:"6.5+"},
  {word:"nevertheless",phonetic:"/ËŒnevÉ™Ã°É™Ëˆles/",chinese:"ç„¶è€Œ",englishDef:"In spite of that; however",example:"It was expensive; nevertheless, we bought it.",exampleTrans:"å®ƒå¾ˆè´µï¼›ç„¶è€Œï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¹°äº†ã€‚",level:"6.5+"},
  {word:"obtain",phonetic:"/É™bËˆteÉªn/",chinese:"è·å¾—",englishDef:"To get or acquire",example:"How did you obtain this information?",exampleTrans:"ä½ æ˜¯å¦‚ä½•è·å¾—è¿™äº›ä¿¡æ¯çš„ï¼Ÿ",level:"6.0+"},
  {word:"obvious",phonetic:"/ËˆÉ’bviÉ™s/",chinese:"æ˜æ˜¾çš„",englishDef:"Easily perceived or understood",example:"It was obvious that he was lying.",exampleTrans:"å¾ˆæ˜æ˜¾ä»–åœ¨æ’’è°ã€‚",level:"5.5+"},
  {word:"persist",phonetic:"/pÉ™ËˆsÉªst/",chinese:"åšæŒ",englishDef:"To continue firmly despite difficulty",example:"If symptoms persist, see a doctor.",exampleTrans:"å¦‚æœç—‡çŠ¶æŒç»­ï¼Œè¯·çœ‹åŒ»ç”Ÿã€‚",level:"6.5+"},
  {word:"phenomenon",phonetic:"/fÉ™ËˆnÉ’mÉªnÉ™n/",chinese:"ç°è±¡",englishDef:"A fact or situation that is observed",example:"Climate change is a global phenomenon.",exampleTrans:"æ°”å€™å˜åŒ–æ˜¯ä¸€ä¸ªå…¨çƒæ€§ç°è±¡ã€‚",level:"7.0+"},
  {word:"presume",phonetic:"/prÉªËˆzjuËm/",chinese:"å‡å®š",englishDef:"To suppose something is true without proof",example:"I presume you've heard the news.",exampleTrans:"æˆ‘æƒ³ä½ å·²ç»å¬åˆ°è¿™ä¸ªæ¶ˆæ¯äº†ã€‚",level:"6.5+"}
];

let currentAudio = null;
let isPlaying = false;

// ==================== TTS Functions ====================
async function speakWithAzureTTS(text, voice = TODAY_VOICE) {
  stopAllAudio();
  showLoading(true);

  try {
    if (!TTS_PROXY_URL || TTS_PROXY_URL.includes('YOUR-TTS-DOMAIN')) {
      throw new Error('æœªé…ç½®TTSä»£ç†');
    }

    const url = `${TTS_PROXY_URL}?text=${encodeURIComponent(text)}&voice=${voice}`;
    const response = await fetch(url);

    if (!response.ok) {
      throw new Error(`TTSè¯·æ±‚å¤±è´¥: ${response.status}`);
    }

    const audioBlob = await response.blob();
    const audioUrl = URL.createObjectURL(audioBlob);

    showLoading(false);
    return playAudioFromUrl(audioUrl);

  } catch (error) {
    console.error('Azure TTSå¤±è´¥ï¼Œä½¿ç”¨æµè§ˆå™¨è¯­éŸ³:', error);
    showLoading(false);
    speakWithFallback(text);
  }
}

function playAudioFromUrl(audioUrl) {
  currentAudio = new Audio(audioUrl);
  currentAudio.onended = () => {
    isPlaying = false;
  };
  isPlaying = true;
  return currentAudio.play();
}

function speakWithFallback(text) {
  if ('speechSynthesis' in window) {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US';
    utterance.rate = 0.8;
    utterance.onend = () => { isPlaying = false; };
    currentAudio = utterance;
    isPlaying = true;
    speechSynthesis.speak(utterance);
  }
}

function stopAllAudio() {
  if (currentAudio instanceof Audio) {
    currentAudio.pause();
    currentAudio.currentTime = 0;
  } else if (currentAudio) {
    speechSynthesis.cancel();
  }
  isPlaying = false;
}

function showLoading(show) {
  document.getElementById('loading').style.display = show ? 'inline' : 'none';
}

function playWord(word) { speakWithAzureTTS(word, TODAY_VOICE); }
function playExample(sentence) { speakWithAzureTTS(sentence, EXAMPLE_VOICE); }

async function playAllWords() {
  const words = getTodayWords();
  for (let w of words) {
    await speakWithAzureTTS(w.word, TODAY_VOICE);
    await new Promise(r => setTimeout(r, 500));
  }
}

async function playAllExamples() {
  const words = getTodayWords();
  for (let w of words) {
    await speakWithAzureTTS(w.example, EXAMPLE_VOICE);
    await new Promise(r => setTimeout(r, 800));
  }
}

// ==================== Data Functions ====================
function dateKey() { return new Date().toISOString().split('T')[0]; }

function seededShuffle(array, seed) {
  let hash = 0;
  for (let i = 0; i < seed.length; i++) {
    hash = ((hash << 5) - hash) + seed.charCodeAt(i);
    hash |= 0;
  }
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    hash = (hash * 1103515245 + 12345) & 0x7fffffff;
    const j = hash % (i + 1);
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function getTodayWords(forceNew=false) {
  const k = dateKey();
  const store = JSON.parse(localStorage.getItem('vocabHistory')||'{}');
  if(!forceNew && store[k] && store[k].length===10) return store[k];
  const picked = seededShuffle(IELTS_VOCAB, k + (forceNew?'-force':'')).slice(0,10);
  store[k]=picked;
  localStorage.setItem('vocabHistory', JSON.stringify(store));
  return picked;
}

// ==================== Render Functions ====================
function renderToday(forceNew=false) {
  const words = getTodayWords(forceNew);
  const el = document.getElementById('today');
  const today = dateKey();
  
  document.getElementById('today-date').textContent = `ä»Šæ—¥æ—¥æœŸï¼š${today}ï¼ˆ${words.length}ä¸ªé›…æ€è¯æ±‡ï¼‰`;
  
  el.innerHTML = words.map((w, i) => `
    <div class="card">
      <div class="card-header">
        <div>
          <span class="word">${i+1}. ${w.word}</span>
          <span class="phonetic">${w.phonetic}</span>
        </div>
        <span class="level">${w.level}</span>
      </div>
      <div class="meaning">ğŸ“– ${w.chinese}</div>
      <div class="definition">${w.englishDef}</div>
      <div class="example">
        <div class="example-text">ğŸ’¬ ${w.example}</div>
        <div class="example-trans">${w.exampleTrans}</div>
      </div>
      <div class="btn-group">
        <button onclick="playWord('${w.word}')">ğŸ”Š å•è¯å‘éŸ³</button>
        <button onclick="playExample('${w.example.replace(/'/g, "\\'")}')">ğŸ§ ä¾‹å¥å‘éŸ³</button>
      </div>
    </div>
  `).join('');
  
  updateProgress(words.length, 10);
}

function renderHistory() {
  const store = JSON.parse(localStorage.getItem('vocabHistory')||'{}');
  const days = Object.keys(store).sort().reverse();
  const el = document.getElementById('history');
  
  let totalWords = 0;
  days.forEach(day => { totalWords += (store[day] || []).length; });
  document.getElementById('total-words').textContent = totalWords;
  
  el.innerHTML = days.map(day => {
    const words = store[day] || [];
    return `
      <div class="history-item">
        <div class="history-header" onclick="toggleHistory('${day}')">
          <span class="history-date">ğŸ“… ${day}</span>
          <span class="history-badge">${words.length}è¯ å·²å­¦</span>
        </div>
        <div class="history-words" id="history-${day}">
          ${words.map((w, i) => `
            <div class="history-word-item">
              <div class="history-word-main">
                <div class="history-word-text">
                  ${i+1}. <strong>${w.word}</strong>
                  <span class="history-word-phonetic">${w.phonetic}</span>
                </div>
                <div class="history-word-meaning">${w.chinese} - ${w.englishDef}</div>
              </div>
              <button onclick="playWord('${w.word}')">ğŸ”Š</button>
            </div>
          `).join('')}
        </div>
      </div>
    `;
  }).join('');
}

function toggleHistory(day) {
  const el = document.getElementById(`history-${day}`);
  el.classList.toggle('active');
}

function updateProgress(current, total) {
  const percent = (current / total) * 100;
  document.getElementById('progress').style.width = percent + '%';
}

function refreshToday(force) {
  renderToday(force);
  renderHistory();
}

// ==================== åˆå§‹åŒ– ====================
document.addEventListener('DOMContentLoaded', () => {
  refreshToday(false);
});
</script>
<!-- Daily vocab script run at 2026-02-23 08:00 -->
</body>
</html>
